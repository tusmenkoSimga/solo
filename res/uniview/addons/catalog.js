/*! Cortona3D Solo Universal Viewer bundle - catalog, Copyright (c) 2015-2018 Paragraphics, Ltd. (http://www.cortona3d.com/) */
define(function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,n){var r;void 0!==(r=function(t,e,n){function r(t,e){for(var n=t.length,r=e.length,i=0,o=[],a=0;a<n;a++){for(var c=0,p=0;e[c]!==t[a]&&c<r;)c++;for(;o[p]!==t[a]&&p<i;)p++;c!=r&&p==i&&(o[i++]=t[a])}return o}function i(t,e){for(var n=t.length,r=e.length,i=0,o=[],a=0;a<n;a++){for(var c=0,p=0;e[c]!==t[a]&&c<r;)c++;for(;o[p]!==t[a]&&p<i;)p++;c==r&&p==i&&(o[i++]=t[a])}return o}function o(t,e){var n=t.length,r=e.length,i=0,o=[];o=t,i=n;for(var a=0;a<r;a++){for(var c=!1,p=0;p<n;p++)if(o[p]==e[a]){c=!0;break}!1===c&&(o[i++]=e[a])}return o}function a(t,e){for(var n=t.length,r=e.length,i=0,o=[],a=0;a<n;a++){for(var c=0,p=0;e[c]!==t[a]&&c<r;)c++;for(;o[p]!==t[a]&&p<i;)p++;c==r&&p==i&&(o[i++]=t[a])}for(var a=0;a<r;a++){for(var c=0,p=0;t[c]!==e[a]&&c<n;)c++;for(;o[p]!==e[a]&&p<i;)p++;c==n&&p==i&&(o[i++]=e[a])}return o}n.exports={intersection:r,difference:i,union:o,xor:a}}.call(e,n,e,t))&&(t.exports=r)},,,,,,function(t,e,n){var r;void 0!==(r=function(t,e,r){function i(t){if(t>=0){var e=g.getIndexByRow(t);return e>=0?e:i(g.getParent(t))}return-1}function o(t){var e=[];if(t>=0){e=x.reduce(function(t,e){return v(t,[e].concat(g.getChildren(e,!0)))},[]).reduce(function(t,e){return t.concat(g.getObjectsNamesByRow(e))},[]).reduce(function(t,e){return t.concat(l.app.getObjectWithName(e)||[])},[])}l.app.setSelectedObjects(e,!0),R=e}function a(t,e){t in w||(w[t]={transparency:0,visible:!0}),w[t].transparency=e}function c(t){return t in w||(w[t]={transparency:0,visible:!0}),w[t].transparency}function p(t){w={},d(),l.app.restoreObjectProperty(0,l.app.PROPERTY_TRANSPARENCY,t),l.app.restoreObjectProperty(0,l.app.PROPERTY_VISIBILITY,t),O.filter.resetAll()}function d(){S.length&&l.dispatch("app.ipc.didChangeItemVisibility",!0,S),S=[],l.dispatch("catalog.didChangeHiddenItems",S)}function u(t,e,n,r){var i=g.getRowByIndex(t),o=g.getObjectsForRow(i,r),a=-1!==j.indexOf(i),c=!1===e?[t]:[],p=!0===e?[t]:[];o.forEach(function(t){var n=e;void 0===e&&(n=!l.app.isObjectVisible(t));var r=g.getIndexByRow(g.getRowByObjectName(l.app.getObjectName(t)));r>=0&&p.indexOf(r)<0&&c.indexOf(r)<0&&(n?p:c).push(r),n&&!a?l.app.restoreObjectProperty(t,l.app.PROPERTY_VISIBILITY,!1):l.app.setObjectPropertyf(t,l.app.PROPERTY_VISIBILITY,!1,-1)}),n||(c.length&&l.dispatch("app.ipc.didChangeItemVisibility",!1,c),p.length&&l.dispatch("app.ipc.didChangeItemVisibility",!0,p))}function f(t,e,n){if(e)2===e&&t>=0&&s.toggleSelection(t);else{var r=g.getRowByIndex(t);x.indexOf(r)>=0&&(t=-1),s.selectItem(t),l.dispatch("catalog.didSelectItem",t,n)}t<0&&(T=-1),l.dispatch("catalog.didChangeSelection",Array.prototype.slice.call(x))}var l=window.Cortona3DSolo,s=l.app.ipc,g=s.interactivity;l.core?l.app.configureInstance(l.app.DISABLE_DOCUMENT_INTERACTIVITY):n(7);var h=n(0),v=(h.xor,h.union),I=h.intersection,m=h.difference,y=n(8),b=!1,O={filter:n(9)},w={},x=[],R=[],S=[],j=[],C={};g.json.$("ipc/figure/dplist/item").forEach(function(t){t.$("commands/command").forEach(function(t){C[t.$attr("id")]=t})});var P=g.getRowByIndex,B=g.getIndexByRow,E=s.resetCurrentSheet;l.use("drawing"),l.app.initialize(),l.expand(l.app,{isObjectVisible:function(t){return-1===(l.app.getObjectsWithDirtyProperty(l.app.PROPERTY_VISIBILITY)||[]).indexOf(t)},isSelectedObjectsVisible:function(){var t=l.app.getSelectedObjects()||[],e=l.app.getObjectsWithDirtyProperty(l.app.PROPERTY_VISIBILITY)||[];return 0===I(t,e).length},toggleSelectedObjectsVisibility:function(t){var e=l.app.getSelectedObjects()||[],n=void 0===t?l.app.isSelectedObjectsVisible():!t,r=[];return e.forEach(function(t){var e=g.getIndexByRow(g.getRowByObjectName(l.app.getObjectName(t)));e>=0&&r.indexOf(e)<0&&r.push(e),n?l.app.setObjectPropertyf(t,l.app.PROPERTY_VISIBILITY,!1,-1):l.app.restoreObjectProperty(t,l.app.PROPERTY_VISIBILITY,!1)}),r.length&&l.dispatch("app.ipc.didChangeItemVisibility",!n,r),!n},setSelectedObjectsTransparency:function(t,e){(l.app.getSelectedObjects()||[]).forEach(function(e){l.app.setObjectPropertyf(e,l.app.PROPERTY_TRANSPARENCY,!1,t),a(l.app.getObjectName(e),t)})},getSelectedObjectsTransparency:function(){return(l.app.getSelectedObjects()||[]).reduce(function(t,e){var n=l.app.getObjectName(e);return Math.max(c(n),t)},0)},getSelectedObjects:function(){return R}}),Object.defineProperty(s,"fullDPLMode",{get:function(){return b},set:function(t){b!==t&&(b=t,l.dispatch("app.ipc.didSelectSheet",s.getCurrentSheet()))},enumerable:!0,configurable:!0}),Object.defineProperty(s,"selectedItems",{get:function(){return Array.prototype.slice.call(x)},enumerable:!0}),Object.defineProperty(s,"dplTable",{get:function(){var t=g.getSheetInfo(s.currentSheetInfo.id);return(b?y.getFullDPLTable(g.json):y.getDPLTable(g.json,t.items))||""},enumerable:!0,configurable:!0}),l.expand(s,{selectSheet:function(t,e){return t===s.currentSheetInfo.id?Promise.resolve(s.currentSheetInfo):new Promise(function(n,r){l.once("app.ipc.didSelectSheet",function(e){e.id===t&&n(e)}),s.setCurrentSheet(t,e)})},hoverItem:function(t){l.app.restoreObjectProperty(0,l.app.PROPERTY_EMISSIVE_COLOR,!0);var e=g.getRowByIndex(t);g.getObjectsForRow(e).forEach(function(t){l.app.setObjectPropertyf(t,l.app.PROPERTY_EMISSIVE_COLOR,!0,.5,.5,.5)}),s.dpl.hoverRow(t),l.app.drawing.hoverItem(t),l.dispatch("catalog.didHoverItem",t)},selectItem:function(t){var e=g.getRowByIndex(t);s.isItemActive(e)||(e=-1),x.forEach(function(t){var e=g.getIndexByRow(t);s.dpl.selectRow(e,!1),l.app.drawing.selectItem(e,!1)}),x=e<0?[]:[e];var n=[];e>=0&&(n=g.getObjectsForRow(e)),l.app.setSelectedObjects(n,!0),R=n,x.forEach(function(t){var e=g.getIndexByRow(t);s.dpl.selectRow(e),l.app.drawing.selectItem(e)})},addSelection:function(t){var e=g.getRowByIndex(t);if(s.isItemActive(e)){x.indexOf(e)<0&&(s.dpl.selectRow(t),l.app.drawing.selectItem(t),x.push(e),o(e))}},removeSelection:function(t){var e=g.getRowByIndex(t);if(s.isItemActive(e)){var n=x.indexOf(e);n>=0&&(s.dpl.selectRow(t,!1),l.app.drawing.selectItem(t,!1),x.splice(n,1),o(e))}},toggleSelection:function(t,e){var n=g.getRowByIndex(t),r=x.indexOf(n);e=void 0===e?r<0:e,e?s.addSelection(t):s.removeSelection(t)},fitItem:function(t,e,n){var r=g.getRowByIndex(t),i=g.getObjectsForRow(r);l.app.fitObjectsInView(i,e,n)},toggleItemVisibility:u,getCurrentSheetItems:function(){var t=s.getCurrentSheet().id;g.json;return g.getSheetInfo(t).items.map(function(t){return g.getItemInfo(t)})},isItemActive:function(t){var e=s.getCurrentSheet().id;return e&&g.getSheetInfo(e).items.indexOf(t)>=0},isItemVisible:function(t){return S.indexOf(g.getIndexByRow(t))<0},resetCurrentSheet:function(t){E(t),p(t)},restoreAllItemsVisibility:function(t){S.forEach(function(t){u(t,!0)}),d()}}),l.expand(s.interactivity,{getRowByIndex:function(t){return b||t<0?t:P(t)},getIndexByRow:function(t){return b||t<0?t:B(t)},getObjectsForRow:function(t,e){if(t<0)return[];void 0===e&&(e=!0);var n=[t];return e&&(n=n.concat(g.getChildren(t,!0))),n.reduce(function(t,e){return t.concat(g.getObjectsNamesByRow(e))},[]).reduce(function(t,e){return t.concat(l.app.getObjectWithName(e)||[])},[])},getSheetsForRow:function(t){return l.app.getDocumentInfo().sheets.filter(function(e){return e.items.indexOf(t)>=0})},getDPLColumnIndexById:function(t){for(var e=g.json,n=e.$("ipc/figure/ipc-table/table/thead/row/entry"),r=n.length-1;r>=0&&n[r].$attr("column-id")!==t;)r-=1;return r},getCommandById:function(t){return C[t]}}),l.app.drawing=l.expand(l.app.drawing||{},{hoverItem:function(t){if(l.app.drawing.hoverHotspot){var e=g.getItemByIndex(t);l.app.drawing.hoverHotspot(e)}},selectItem:function(t,e){var n;if(l.app.drawing.selectHotspot){!1===e&&(n="");var r=g.getItemByIndex(t);l.app.drawing.selectHotspot(r,n)}}}),l.on("app.ipc.dpl.didHoverRow",s.hoverItem),l.on("app.ipc.didHoverItem",s.hoverItem),l.on("app.drawing.didHoverHotspot",function(t,e){var n=e?this.app.ipc.interactivity.getIndexByItem(t):-1;this.app.ipc.hoverItem(n),this.dispatch("app.drawing.didHoverItem",n)});var T=-1;l.on("app.ipc.dpl.didSelectRow",function(t,e){if(1===e&&T>=0){var n=g.getIndexByRow(T);s.selectItem(n);var r=t-n;if(0!==r){r=r>0?1:-1;for(var i=n;i!=t;)i+=r,s.toggleSelection(i);l.dispatch("catalog.didChangeSelection",Array.prototype.slice.call(x))}}else T=g.getRowByIndex(t),f(t,e,l.app.ipc.dpl)}),l.on("app.ipc.didSelectItem",function(t,e){f(t,e,l.app.ipc)}),l.on("app.drawing.didSelectHotspot",function(t,e){var n=this.app.ipc.interactivity.getIndexByItem(t);f(n,e,l.app.drawing),this.dispatch("app.drawing.didSelectItem",n,e)}),l.on("app.didCallContextMenu",function(t,e,n){var r=-1,o=this.app.pickObject(t,e);o&&(r=this.app.ipc.interactivity.getRowByObjectName(o.name),b||(index=i(r),r=this.app.ipc.interactivity.getRowByIndex(index))),this.dispatch("catalog.didCallContextMenu",r,t,e,n)}),l.on("app.drawing.didCallContextMenu",function(t,e,n,r){var i=-1;t&&(i=this.app.ipc.interactivity.getRowByItem(t)),this.dispatch("catalog.didCallContextMenu",i,e,n,r)}),l.on("app.ipc.dpl.didCallContextMenu",function(t,e,n,r){var i=g.getRowByIndex(t);this.dispatch("catalog.didCallContextMenu",i,e,n,r)}),l.on("touch.didObjectEnter",function(t,e){var n=g.getRowByObjectName(e),r=n;b||(r=i(n)),this.dispatch("app.ipc.didHoverItem",r)}),l.on("touch.didObjectOut",function(t,e){this.dispatch("app.ipc.didHoverItem",-1)}),l.on("touch.didObjectClick",function(t,e,n,r,o,a,c){if(1===o&&!(-3&a)&&("function"!=typeof this.catalog.willObjectClick||this.catalog.willObjectClick(t,e,n,r,o,a,c))){var p=g.getRowByObjectName(e),d=p;b||(d=i(p)),this.dispatch("app.ipc.didSelectItem",d,a)}}),l.on("app.ipc.didSelectSheet",function(){p(!1),this.dispatch("app.ipc.didSelectItem",-1),this.dispatch("app.ipc.didHoverItem",-1)}),l.on("app.ipc.didChangeItemVisibility",function(t,e){var n=S.map(function(t){return g.getRowByIndex(t)});S=t?m(S,e):v(S,e),this.dispatch("catalog.didChangeHiddenItems",S.map(function(t){return g.getRowByIndex(t)}),n)}),l.on("catalog.didChangeFilteredItems",function(t,e){j=t,m(e,t).forEach(function(t){var e=g.getIndexByRow(t);-1===S.indexOf(e)&&u(e,!0,!0,!1)}),m(t,e).forEach(function(t){var e=g.getIndexByRow(t);-1===S.indexOf(e)&&u(e,!1,!0,!1)})}),l.catalog=O,r.exports=O}.call(e,n,e,t))&&(t.exports=r)},function(t,e,n){var r;void 0!==(r=function(t,e,n){var r=window.Cortona3DSolo,i=r.app.ipc;i.interactivity;r.core||r.expand(r.app,{ipc:{getCurrentSheet:function(){}}})}.call(e,n,e,t))&&(t.exports=r)},function(t,e,n){var r;void 0!==(r=function(t,e,n){function r(t){d||(d={},t.$("ipc/figure/dplist/item").forEach(function(t){t.$("commands/command").forEach(function(t){d[t.$attr("id")]=t})}))}function i(t){u=[];var e=t.$("thead/row/entry"),n=e.reduce(function(t,e,n,r){return t+(+e.$attr("width")||0)},0);return"<colgroup>"+e.reduce(function(t,e,r,i){var o=+e.$attr("width")||0,a=Math.floor(100*o/n)+"%";return u.push({width:o,col:a}),t+'<col width="'+a+'">'},"")+"</colgroup>"}function o(t){var e=t.$("thead/row/entry"),n=e.reduce(function(t,e,n){return t+'<td width="'+u[n].col+'"><pre>'+e.$text("para")+"</pre></td>"},"");return n="<thead><tr>"+n+"</tr></thead>"}function a(t){var e=u.reduce(function(t,e){var n=new Array(Math.max(1,e.width)+1).join("W");return t+'<td width="'+e.col+'" class="strut"><div><pre>'+n+"</pre></div></td>"},"<tr>")+"</tr>";return e+=t.reduce(function(t,e,n){var r="row"+n,i=e.$attr("refItem");return t+(e.$("entry").reduce(function(t,e){return t+"<td><pre>"+(e.$text("para")||e.$("cmdtext").reduce(function(t,e){return t+'<span class="command" data-ref="'+e.$attr("refCmd")+'" data-type="'+d[e.$attr("refCmd")].$attr("type")+'">'+e.$text()+"</span>"},"")||"&nbsp;")+"</pre></td>"},'<tr id="'+r+'" data-ref="'+i+'">')+"</tr>")},""),e="<tbody>"+e+"</tbody>"}function c(t){var e=t.$("ipc/figure/ipc-table/table")[0],n=e.$("tbody/row");r(t);var c='<table id="dpl-table" class="dpl-table">';return c+=i(e),c+=o(e),c+=a(n),c+="</table>"}function p(t,e){var n=t.$("ipc/figure/ipc-table/table")[0],c=n.$("tbody/row").filter(function(t,n){return e.indexOf(n)>=0});r(t);var p='<table id="dpl-table" class="dpl-table">';return p+=i(n),p+=o(n),p+=a(c),p+="</table>"}var d,u=[];n.exports={getFullDPLTable:c,getDPLTable:p}}.call(e,n,e,t))&&(t.exports=r)},function(t,e,n){var r;void 0!==(r=function(t,e,n){function r(t,e,n){p[t]||("function"!=typeof e&&(e=function(){}),p[t]={name:t,values:n,test:e})}function i(t){delete p[t],delete d[t],c()}function o(t,e){d[t]=e,Cortona3DSolo.dispatch("catalog.didChangeFilterValue",t,e),c()}function a(){for(var t in p)delete d[t],Cortona3DSolo.dispatch("catalog.didChangeFilterValue",t);c()}function c(){var t=Cortona3DSolo.app.ipc.interactivity,e=[];return e=t.json.$("ipc/figure/dplist/item").map(function(e,n){var r=!0;for(var i in p)if(!(r=void 0===d[i]||"*"===d[i]||p[i].test(t.getItemInfo(n),d[i])))break;return r?-1:n}).filter(function(t){return t>=0}),u.toString()!==e.toString()&&(Cortona3DSolo.dispatch("catalog.didChangeFilteredItems",e,u),u=e),e}var p={},d={},u=[];n.exports={create:r,set:o,resetAll:a,remove:i,testMeta:function(t,e,n){var r=(e.metadata[t]||"").trim();return!r||r===n},testCommand:function(t,e,n,r){return n.commands.some(function(n){return n.type===t&&n.args[e]===r})},valuesMeta:function(t){var e=Cortona3DSolo.app.ipc.interactivity,n=[];return e.json.$("ipc/figure/dplist/item").forEach(function(r,i){var o=e.getItemInfo(i),a=(o.metadata[t]||o.part.metadata[t]||"").trim();a&&n.indexOf(a)<0&&n.push(a)}),n},valuesCommand:function(t,e){e=e||0;var n=Cortona3DSolo.app.ipc.interactivity,r=[];return n.json.$("ipc/figure/dplist/item").forEach(function(i,o){var a=n.getItemInfo(o);a.commands.filter(function(e){return e.type===t}).map(function(t){return!t.args.length||t.args[e]}).forEach(function(t){t&&r.indexOf(t)<0&&r.push(t)})}),r}}}.call(e,n,e,t))&&(t.exports=r)}])});