/*! Cortona3D Solo Universal Viewer bundle - procedure, Copyright (c) 2015-2018 Paragraphics, Ltd. (http://www.cortona3d.com/) */
define(function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=11)}({11:function(e,t,r){var n;void 0!==(n=function(e,t,r){function n(){return!!(1&(b||0))}function a(){P.setPlayRange("object"==typeof h?h.start:S,"object"==typeof h?h.end:null,P.RANGE_FLAGS_REQUEST_NOTIFICATION|P.RANGE_FLAGS_DO_NOT_RECALCULATE_POSITION);var e=P.getPlayableRangeStartTime(),t=P.getPlayableRangeStopTime();I.dispatch("app.procedure.didChangePlayableRange",e,t)}function o(){if(h&&(P.stop(),P.setPlayRange()),y){var e=y.indexOf(S)-1;e>=0&&v(y[e])}else R();h&&a()}function c(){if(h&&(P.stop(),P.setPlayRange()),y){var e=y.indexOf(S)+1;e<y.length&&v(y[e])}else _();h&&a()}function p(e){if(h&&(P.stop(),P.setPlayRange()),E){var t=E.getProcedureId(),r=E.getProcedureItemInfo(e);if(r||(e=t,r=E.getProcedureItemInfo(e)),r){switch(y=[],r.type){case"procedure":y=E.getProcedureItemInfo(t).raw["@children"];break;case"step":y=E.getProcedureItemInfo(r.parent).raw["@children"];break;case"action":y=E.getProcedureItemInfo(r.parentStep).raw["@children"]}y=y||[],y=y.reduce(function(e,t){var r=t.$attr("id");return r&&(m||t.$text("Comment"))?e.concat(r):e},[])}}v&&(v(e),I.app.procedure.requestPlayerState()),h&&a()}function i(e){var t,r=e||g;if(E)if(y){if(r)for(;r&&y.indexOf(r)<0;)t=E.getProcedureItemInfo(r)||{},r=t.parent;r||(r=P.RANGE_VALUE_CURRENT_STEP)}else r=E.getProcedureId();else r=P.RANGE_VALUE_CURRENT_STEP;return r}function d(e){I.app.drawing.show(e),I.app.ui.showCanvas(!e),I.dispatch("app.procedure.didDrawingDisplayMode",e)}function u(e,t){if(e){E.getObjectNamesByDocId(e).map(I.app.getObjectWithName).forEach(function(e){t?I.app.setObjectPropertyf(e,I.app.PROPERTY_EMISSIVE_COLOR,!0,.5,.5,.5):I.app.restoreObjectProperty(e,I.app.PROPERTY_EMISSIVE_COLOR,!0)})}}function f(e,t){}function l(e){return E.getObjectNamesByDocId(e).map(I.app.getObjectWithName).some(function(e){return 0===I.app.getObjectVisibility(e)})}function s(e,t){function r(t){o=arguments.length?t:!o,e.forEach(function(e){o?I.app.setObjectPropertyf(e,I.app.PROPERTY_EMISSIVE_COLOR,!0,.7,.7,.2):I.app.restoreObjectProperty(e,I.app.PROPERTY_EMISSIVE_COLOR,!0)})}function n(){clearInterval(a),delete T[a],r(!1)}var a,o=!1;t=t||3,I.app.fitObjectsInView(e,!0,.5),a=setInterval(r,250),T[a]={finish:n,timeout:setTimeout(n,1e3*t)}}function O(){for(var e in T)clearInterval(e),clearTimeout(T[e].timeout),T[e].finish()}var b,g,I=window.Cortona3DSolo,P=I.app.procedure,E=P.interactivity,m=E&&!!E.json.$text("SimulationInteractivity/SimulationInformation/DocumentFile"),h=!1,y=null,S=P.RANGE_VALUE_CURRENT_STEP,j=0;if(P){var R=P.backward,_=P.forward,v=P.seekToSubstep;P.defaultSeekMode=P.SEEK_TO_CUE_POINT,E&&I.on("app.procedure.didEnterSubstepWithName",function(e){g=e,S=i(e);var t=S===E.getProcedureId(),r=!1,n=!1;if(y&&!t){var a=y.indexOf(S);r=a<y.length-1,n=a>0}I.dispatch("app.procedure.didEnableForward",r),I.dispatch("app.procedure.didEnableBackward",n)}),I.on("app.procedure.didChangePlayerState",function(e,t){var r=void 0===b?16777215:t^b;b=t,j=e,1&r&&(n()?(I.dispatch("app.procedure.didPlay"),I.app.procedure.requestPlayerState()):I.dispatch("app.procedure.didStop")),1024&r&&I.dispatch("app.procedure.didPlaySound",!!(1024&t)),256&r&&I.dispatch("app.procedure.didEnableForward",!!(256&t)),512&r&&I.dispatch("app.procedure.didEnableBackward",!!(512&t)),0===e?(I.dispatch("app.procedure.onStartPosition"),1&r&&n()&&I.dispatch("app.procedure.didStart")):e>=I.app.procedure.duration&&(I.dispatch("app.procedure.onEndPosition"),1&r&&(n()||I.dispatch("app.procedure.didFinish")))}),Object.defineProperty(I.app.procedure,"locked",{get:function(){return h},set:function(e){h=e,h?a():P.setPlayRange(null,null,P.RANGE_FLAGS_DO_NOT_RECALCULATE_POSITION)},enumerable:!0,configurable:!0}),Object.defineProperty(I.app.procedure,"played",{get:n,enumerable:!0,configurable:!0}),Object.defineProperty(I.app.procedure,"position",{get:function(){return j},enumerable:!0,configurable:!0}),Object.defineProperty(I.app.procedure,"state",{get:function(){return b},enumerable:!0,configurable:!0});var T={};I.expand(I.app.procedure,{forward:c,backward:o,seekToSubstep:p,toggleDrawingDisplayMode:d,getContextItemId:i,hoverItem:u,selectItem:f,isItemVisible:l,drawAttention:s,clearAllAttentions:O});E&&(I.expand(E,{getDocIdForObject:function(e){for(var t=E.getDocIdByObjectName(I.app.getObjectName(e));!t&&e;)e=I.app.getParentObject(e),t=E.getDocIdByObjectName(I.app.getObjectName(e));return t},getScreenTip:function(e){return(E.getDocItemInfo(E.getDocIdByObjectName(e))||{}).screentip}}),I.on("touch.didObjectEnter",function(e,t){var r=E.getDocIdForObject(e);r&&I.dispatch("procedure.didObjectEnter",r)}),I.on("touch.didObjectOut",function(e,t){var r=E.getDocIdForObject(e);r&&I.dispatch("procedure.didObjectOut",r)}),I.on("touch.didObjectClick",function(e,t){var r=E.getDocIdForObject(e);r&&I.dispatch("procedure.didObjectClick",r)}),p(E.getProcedureId()))}}.call(t,r,t,e))&&(e.exports=n)}})});